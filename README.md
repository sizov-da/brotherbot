# ๐ค BrotherBot

**BrotherBot** โ ััะพ ัะพะฒัะตะผะตะฝะฝะพะต ะฒะตะฑ-ะฟัะธะปะพะถะตะฝะธะต ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะทะฐะดะฐัะฐะผะธ ั ะธะฝัะตะณัะฐัะธะตะน Telegram ะธ real-time ะบะพะผะผัะฝะธะบะฐัะธะตะน, ะฟะพัััะพะตะฝะฝะพะต ะฝะฐ ะฐััะธัะตะบัััะต ะผะธะบัะพัะตัะฒะธัะพะฒ.

## ๐ฏ ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

- **๐ ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะดะฐัะฐะผะธ**: ะกะพะทะดะฐะฝะธะต, ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต, ัะดะฐะปะตะฝะธะต ะทะฐะดะฐั ั ะฟะพะดะดะตัะถะบะพะน ะธะตัะฐััะธะธ ะฟะพะดะทะฐะดะฐั
- **๐ ะััะตัะฝะพััั**: ะะตัะฐะปัะฝัะต ะพััะตัั ะฟะพ ะทะฐะดะฐัะฐะผ ั ััะตัะพะผ ะฒัะตะผะตะฝะธ ะธ ะทะฐััะฐั  
- **๐ ะะฐะปะตะฝะดะฐัั**: ะะธะทัะฐะปะธะทะฐัะธั ะทะฐะดะฐั ะฒ ะบะฐะปะตะฝะดะฐัะฝะพะผ ะฟัะตะดััะฐะฒะปะตะฝะธะธ ั ะดะธะฐะณัะฐะผะผะฐะผะธ
- **๐ฌ Real-time ัะฐั**: ะะณะฝะพะฒะตะฝะฝัะน ะพะฑะผะตะฝ ัะพะพะฑัะตะฝะธัะผะธ ะผะตะถะดั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
- **๐ Telegram ะฐะฒัะพัะธะทะฐัะธั**: ะะตะทะพะฟะฐัะฝะฐั ะฐััะตะฝัะธัะธะบะฐัะธั ัะตัะตะท Telegram
- **๐ฑ PWA**: ะะพะดะดะตัะถะบะฐ Progressive Web App ะดะปั ะผะพะฑะธะปัะฝัั ััััะพะนััะฒ
- **๐จ ะะดะฐะฟัะธะฒะฝัะน ะดะธะทะฐะนะฝ**: ะกะพะฒัะตะผะตะฝะฝัะน UI ั ะฟะพะดะดะตัะถะบะพะน ะผะพะฑะธะปัะฝัั ััััะพะนััะฒ

## ๐๏ธ ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ

### ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Frontend      โ    โ  Socket Server  โ    โ    ArangoDB     โ
โ   (React/TS)    โโโโโบโ   (Node.js)     โโโโโบโ   (Database)    โ
โ   Port: 3001    โ    โ   Port: 3000    โ    โ   Port: 8529    โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
         โ                       โ                       โ
         โ              โโโโโโโโโโโโโโโโโโโ              โ
         โโโโโโโโโโโโโโโโบโ  Facade App     โโโโโโโโโโโโโโโโ
                        โ  (GraphQL API)  โ
                        โโโโโโโโโโโโโโโโโโโ
```

### ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

- **`frontend/`** โ React ะฟัะธะปะพะถะตะฝะธะต ั TypeScript
- **`socket_server/`** โ Node.js ัะตัะฒะตั ั Socket.io
- **`db/`** โ ะะพะฝัะธะณััะฐัะธั ArangoDB
- **`facade-app/`** โ GraphQL API ัะตัะฒะธั (ะฒ ัะฐะทัะฐะฑะพัะบะต)
- **`mediator-messenger/`** โ ะกะตัะฒะธั-ะฟะพััะตะดะฝะธะบ ะดะปั ะผะตััะตะฝะดะถะตัะฐ

## ๐ ะัััััะน ััะฐัั

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

- Node.js 16+ 
- Docker ะธ Docker Compose
- Yarn ะธะปะธ npm

### ะฃััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ

1. **ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน**
```bash
git clone <repository-url>
cd brotherbot
```

2. **ะะฐะฟััะบ ัะตัะตะท Docker (ัะตะบะพะผะตะฝะดัะตััั)**
```bash
# ะะพะปะฝัะน ะทะฐะฟััะบ ะฒัะตั ัะตัะฒะธัะพะฒ
docker-compose up -d

# ะคัะพะฝัะตะฝะด ะฑัะดะตั ะดะพัััะฟะตะฝ ะฝะฐ http://localhost:3001
# Backend API ะฝะฐ https://localhost:3000
```

3. **ะะฐะฟััะบ ะดะปั ัะฐะทัะฐะฑะพัะบะธ**

Backend:
```bash
cd socket_server
npm install
npm start
```

Frontend:
```bash
cd frontend
npm install
npm start
```

### ะะพะฝัะธะณััะฐัะธั SSL (ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ)

ะะปั ัะฐะฑะพัั ั HTTPS ะฝะตะพะฑัะพะดะธะผะพ ะฝะฐัััะพะธัั SSL ัะตััะธัะธะบะฐัั:
```bash
# ะะฑะฝะพะฒะธัะต ะฟััะธ ะบ ัะตััะธัะธะบะฐัะฐะผ ะฒ socket_server/index.js
const httpsOptions = {
    key: fs.readFileSync('/path/to/your/privkey.pem'),
    cert: fs.readFileSync('/path/to/your/fullchain.pem'),
    ca: fs.readFileSync('/path/to/your/chain.pem')
};
```

## ๐๏ธ ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

### Frontend
- **React 18** ั TypeScript
- **VK UI Kit** โ ะบะพะผะฟะพะฝะตะฝัั ะธะฝัะตััะตะนัะฐ
- **Ant Design** โ ะดะพะฟะพะปะฝะธัะตะปัะฝัะต UI ะบะพะผะฟะพะฝะตะฝัั  
- **Socket.io Client** โ real-time ะบะพะผะผัะฝะธะบะฐัะธั
- **ECharts** โ ะดะธะฐะณัะฐะผะผั ะธ ะณัะฐัะธะบะธ
- **React Router** โ ะผะฐัััััะธะทะฐัะธั
- **Service Workers** โ PWA ััะฝะบัะธะพะฝะฐะปัะฝะพััั

### Backend
- **Node.js** โ ัะตัะฒะตัะฝะฐั ะฟะปะฐััะพัะผะฐ
- **Socket.io** โ WebSocket ัะพะตะดะธะฝะตะฝะธั
- **ArangoDB** โ ะณัะฐั-ะฑะฐะทะฐ ะดะฐะฝะฝัั
- **@socket.io/sticky** โ ะบะปะฐััะตัะธะทะฐัะธั
- **@telegram-auth/server** โ Telegram ะฐััะตะฝัะธัะธะบะฐัะธั

### ะะฐะทะฐ ะดะฐะฝะฝัั
- **ArangoDB** โ NoSQL ะณัะฐั-ะฑะฐะทะฐ ะดะฐะฝะฝัั
- ะะพะปะปะตะบัะธะธ: users, tasks, reports, messages, sessions

## ๐ก Socket.io API ะกะพะฑััะธั

### ะััะตะฝัะธัะธะบะฐัะธั
- `session` โ ะฟะพะปััะตะฝะธะต ะดะฐะฝะฝัั ัะตััะธะธ
- `authentication_error` โ ะพัะธะฑะบะฐ ะฐััะตะฝัะธัะธะบะฐัะธะธ

### ะะพะปัะทะพะฒะฐัะตะปะธ  
- `users` โ ัะฟะธัะพะบ ะฒัะตั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- `user connected` โ ะฟะพะดะบะปััะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั
- `user disconnected` โ ะพัะบะปััะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั

### ะกะพะพะฑัะตะฝะธั
- `private message` โ ะพัะฟัะฐะฒะบะฐ/ะฟะพะปััะตะฝะธะต ะฟัะธะฒะฐัะฝะพะณะพ ัะพะพะฑัะตะฝะธั

### ะะฐะดะฐัะธ
- `tasks_limit_offset` โ ะฟะพะปััะตะฝะธะต ัะฟะธัะบะฐ ะทะฐะดะฐั ั ะฟะฐะณะธะฝะฐัะธะตะน
- `new task` / `create_task` โ ัะพะทะดะฐะฝะธะต ะฝะพะฒะพะน ะทะฐะดะฐัะธ
- `update_task` โ ะพะฑะฝะพะฒะปะตะฝะธะต ะทะฐะดะฐัะธ
- `delete_task` โ ัะดะฐะปะตะฝะธะต ะทะฐะดะฐัะธ
- `task_created` / `task_updated` / `task_deleted` โ ะฟะพะดัะฒะตัะถะดะตะฝะธั ะพะฟะตัะฐัะธะน

### ะะพะดะทะฐะดะฐัะธ
- `create_subtask` โ ัะพะทะดะฐะฝะธะต ะฟะพะดะทะฐะดะฐัะธ
- `subtask_created` โ ะฟะพะดัะฒะตัะถะดะตะฝะธะต ัะพะทะดะฐะฝะธั

### ะััะตัั
- `add_report` โ ะดะพะฑะฐะฒะปะตะฝะธะต ะพััะตัะฐ ะบ ะทะฐะดะฐัะต
- `update_report` โ ะพะฑะฝะพะฒะปะตะฝะธะต ะพััะตัะฐ  
- `delete_report` โ ัะดะฐะปะตะฝะธะต ะพััะตัะฐ
- `report_added` / `report_updated` / `report_deleted` โ ะฟะพะดัะฒะตัะถะดะตะฝะธั

### ะะตัะฐะปะธ ะทะฐะดะฐั
- `get_task_details` โ ะฟะพะปััะตะฝะธะต ะฟะพะดัะพะฑะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะพ ะทะฐะดะฐัะต
- `task_details` โ ะพัะฒะตั ั ะดะตัะฐะปัะผะธ ะทะฐะดะฐัะธ

## ๐ ะะพะดะตะปั ะดะฐะฝะฝัั

```mermaid
graph TD
    A[ะะฐะดะฐัะฐ Task] -->|ะกะพะดะตัะถะธั| B[ะะพะดะทะฐะดะฐัะฐ Subtask]
    A -->|ะกะฒัะทะฐะฝะฐ ั| C[ะััะตั Report]
    B -->|ะะพะถะตั ัะพะดะตัะถะฐัั| B1[ะะพะดะทะฐะดะฐัะฐ Subtask]
    C -->|ะกะพะดะตัะถะธั ะดะฐะฝะฝัะต| D[ะะฟะธัะฐะฝะธะต ัะฐะฑะพัั]
    C -->|ะกะพะดะตัะถะธั ะดะฐะฝะฝัะต| E[ะะฐััะฐัะตะฝะฝะพะต ะฒัะตะผั]
    C -->|ะกะพะดะตัะถะธั ะดะฐะฝะฝัะต| F[ะะฐััะฐัั]
    C -->|ะกะพะดะตัะถะธั ะดะฐะฝะฝัะต| G[ะะฐัะฐ ัะพะทะดะฐะฝะธั]
    A -->|ะะผะตะตั ััะฐััั| H[ะกัะฐััั pending, in-progress, completed]
    A -->|ะะผะตะตั ะทะฐะณะพะปะพะฒะพะบ| I[ะะฐะณะพะปะพะฒะพะบ]
    A -->|ะะผะตะตั ะพะฟะธัะฐะฝะธะต| J[ะะฟะธัะฐะฝะธะต]
```

## ๐ง ะะฐะทัะฐะฑะพัะบะฐ

### ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะัะพะฒะตัะบะฐ ัััะฐัะตะฒัะธั ะฟะฐะบะตัะพะฒ
npm outdated

# ะะฑะฝะพะฒะปะตะฝะธะต ะฟะฐะบะตัะพะฒ
npx npm-check-updates -u
npm install

# ะัะตะผะตะฝะฝัะน SSL ะดะพะผะตะฝ ะดะปั ัะฐะทัะฐะฑะพัะบะธ
ngrok http 3001
```

### ะกัััะบัััะฐ ะบะพะผะฟะพะฝะตะฝัะพะฒ

**Frontend ะบะพะผะฟะพะฝะตะฝัั:**
- `MainPage` โ ะณะปะฐะฒะฝะฐั ัััะฐะฝะธัะฐ ั ะฝะฐะฒะธะณะฐัะธะตะน
- `BotList` โ ัะฟะธัะพะบ ะทะฐะดะฐั ั ะฟะฐะณะธะฝะฐัะธะตะน
- `BotCalendarPage` โ ะบะฐะปะตะฝะดะฐัะฝะพะต ะฟัะตะดััะฐะฒะปะตะฝะธะต
- `AuthPage` โ ัััะฐะฝะธัะฐ ะฐะฒัะพัะธะทะฐัะธะธ
- `UserProfile` โ ะฟัะพัะธะปั ะฟะพะปัะทะพะฒะฐัะตะปั
- `SettingPage` โ ะฝะฐัััะพะนะบะธ

### ะกะพััะพัะฝะธะต ัะฐะทัะฐะฑะพัะบะธ

- โ ะะฐะทะพะฒะฐั ะฐััะธัะตะบัััะฐ
- โ ะััะตะฝัะธัะธะบะฐัะธั ัะตัะตะท Telegram
- โ CRUD ะพะฟะตัะฐัะธะธ ะดะปั ะทะฐะดะฐั
- โ Real-time ะบะพะผะผัะฝะธะบะฐัะธั
- โ ะะฐะปะตะฝะดะฐัะฝะพะต ะฟัะตะดััะฐะฒะปะตะฝะธะต
- ๐ง ะะพะผะฟะพะฝะตะฝั ะพะฑะฝะพะฒะปะตะฝะธั ะทะฐะดะฐั (ัะตะบััะฐั ะฒะตัะบะฐ)
- ๐ GraphQL API (ะฟะปะฐะฝะธััะตััั)

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

1. ะคะพัะบะฝะธัะต ัะตะฟะพะทะธัะพัะธะน
2. ะกะพะทะดะฐะนัะต ะฒะตัะบั ะดะปั ััะฝะบัะธะธ (`git checkout -b feature/amazing-feature`)
3. ะะฐะบะพะผะผะธัััะต ะธะทะผะตะฝะตะฝะธั (`git commit -m 'Add amazing feature'`)
4. ะะฐะฟััััะต ะฒะตัะบั (`git push origin feature/amazing-feature`)
5. ะัะบัะพะนัะต Pull Request

## ๐ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ัะฐัะฟัะพัััะฐะฝัะตััั ะฟะพะด ะปะธัะตะฝะทะธะตะน MIT.

---

## ๐ ะะพะบัะผะตะฝัะฐัะธั

- **[๐ก API ะดะพะบัะผะตะฝัะฐัะธั](docs/API.md)** โ ะฟะพะปะฝะพะต ะพะฟะธัะฐะฝะธะต Socket.io ัะพะฑััะธะน
- **[๐ ะัะบะพะฒะพะดััะฒะพ ะฟะพ ัััะฐะฝะพะฒะบะต](docs/SETUP.md)** โ ะฟะพะดัะพะฑะฝะฐั ะธะฝััััะบัะธั ะฟะพ ัะฐะทะฒะตัััะฒะฐะฝะธั
- **[๐งฉ ะะพะผะฟะพะฝะตะฝัั ััะพะฝัะตะฝะดะฐ](docs/COMPONENTS.md)** โ ะฐััะธัะตะบัััะฐ React ะฟัะธะปะพะถะตะฝะธั

## ๐ ะะพะปะตะทะฝัะต ัะตััััั

- [PWA ั React](https://create-react-app.dev/docs/making-a-progressive-web-app/)
- [Web App Manifest](https://developers.google.com/web/fundamentals/engage-and-retain/web-app-manifest/)
- [ECharts ะดะปั React](https://echarts.apache.org/handbook/en/basics/import/)
- [Socket.io ะดะพะบัะผะตะฝัะฐัะธั](https://socket.io/docs/)
- [ArangoDB ะดะพะบัะผะตะฝัะฐัะธั](https://www.arangodb.com/docs/)